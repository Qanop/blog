{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/building-rpi-from-the-scratch","result":{"data":{"markdownRemark":{"id":"fb617138-0909-57ee-b29d-c97ea022f603","html":"<p>After the recent chaos I found on my Raspberry Pi server and its unstable performance I made a fresh attempt to build a simple ad filter in my home using rPi.</p>\n<p>First, remember to change default password of <code class=\"language-text\">pi</code> user!</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> raspi-config</code></pre></div>\n<p>Install PiHole from official script, set/reset password for web admin and add auto-update PiHole line to crontab</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">curl</span> -sSL https://install.pi-hole.net <span class=\"token operator\">|</span> <span class=\"token function\">bash</span>\npihole -a -p\n\n<span class=\"token function\">crontab</span> -e\n<span class=\"token comment\"># 0 5 * * * pihole -up</span></code></pre></div>\n<p>I have to admit that PiHole’s basic blacklists do a good job of filtering ads, but there are places on the web that require more url restriction (like scammer sites). I previously used firebog list for this and manually tried to add lists of blocked sites to the tool. However, as it turns out, someone smart has added their <a href=\"https://github.com/jessedp/pihole5-list-tool\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">python script</a> to automatically add the appropriate list option from both <a href=\"https://firebog.net/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">firebog</a> (blacklist) and/or <a href=\"https://github.com/anudeepND/whitelist\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">anudeepND/whitelist</a> (whitelist).</p>\n<p>Also consider adding blocklists focused on your home smart devices:</p>\n<ul>\n<li><a href=\"https://github.com/unknownFalleN/xiaomi-dns-blocklist\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Xiaomi DNS blocklist</a></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> pip3 <span class=\"token function\">install</span> pihole5-list-tool --upgrade\npihole5-list-tool\n\n<span class=\"token comment\">#     ┌──────────────────────────────────────────┐</span>\n<span class=\"token comment\">#     │       π-hole 5 list tool  v0.6.0         │</span>\n<span class=\"token comment\">#     └──────────────────────────────────────────┘</span>\n<span class=\"token comment\">#     https://github.com/jessedp/pihole5-list-tool</span>\n<span class=\"token comment\"># </span>\n<span class=\"token comment\"># ! docker not found running, continuing...</span>\n<span class=\"token comment\"># </span>\n<span class=\"token comment\"># ? Gravity Db to Update:  /etc/pihole/gravity.db</span>\n<span class=\"token comment\"># </span>\n<span class=\"token comment\">#   Blocks Enabled:  All=0   │   Ours=0   │   Allows Enabled:  All=0   │   Ours=0 </span>\n<span class=\"token comment\"># </span>\n<span class=\"token comment\"># ? Options:  Manage Blocklists</span>\n<span class=\"token comment\"># ? Blocklist action:  Add a list</span>\n<span class=\"token comment\"># ? Where are the block lists coming from?  Firebog | Non-crossed lists : Use when someone is usually around to allow</span>\n<span class=\"token comment\"># </span>\n<span class=\"token comment\">#     Do not hit ENTER or Y if a step seems to hang!</span>\n<span class=\"token comment\">#     Use CTRL+C if you're sure it's hung and report it.</span>\n<span class=\"token comment\">#     </span>\n<span class=\"token comment\"># ? Add 45 block lists?  Yes</span>\n<span class=\"token comment\"># 45 block lists added! 0 already existed.</span>\n<span class=\"token comment\">#   Ad/Blocklist Stats   │  Top 3 by Comment                          </span>\n<span class=\"token comment\"># ───────────────────────┼────────────────────────────────────────────</span>\n<span class=\"token comment\">#    Total     :  45/45  │   Firebog | Non-crossed lists [ph5lt]  45  </span>\n<span class=\"token comment\">#    Our Lists :  45/45  │                                            </span>\n<span class=\"token comment\">#    Others    :  0/0    │                                            </span>\n<span class=\"token comment\">#                        │                                            </span>\n<span class=\"token comment\"># ? Are you finished?  Yes</span>\n<span class=\"token comment\"># ? Update Gravity for immediate effect?  Yes</span></code></pre></div>\n<p>The final step is to auto-update the rPi itself. I wanted to use a standard crontab with the update+upgrade command to do this, but the problem here may be the occurrence of a dialog windows. A better solution to avoid this problem and update your rPi server with security payloads is to use the <a href=\"https://wiki.debian.org/UnattendedUpgrades\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">UnattendedUpgrades library</a> </p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> unattended-upgrades\ndpkg-reconfigure -plow unattended-upgrades</code></pre></div>\n<p>This is the most basic server setup, which should take no more than 30min. But it is also a good basis for future activities with the system that is currently set up and running smoothly. In the future, if I add something as a “base image” for the home server, I will add additional commands in the end of this post.</p>","fields":{"slug":"/posts/building-rpi-from-the-scratch","tagSlugs":["/tag/technology/","/tag/ops-dev-ops/"]},"frontmatter":{"date":"2022-01-28T22:58:33.000Z","description":"After the recent chaos I found on my Raspberry Pi server and its unstable performance I made a fresh attempt to build a simple ad filter in my home using rPi","tags":["Technology","Ops / DevOps"],"title":"Building ad-block home server from the scratch. Again...","socialImage":"media/server-4.jpg"}}},"pageContext":{"slug":"/posts/building-rpi-from-the-scratch"}},"staticQueryHashes":["1797451822","251939775","401334301"]}